<!-- Video Creation Tool Section -->
<section id="video-tool" class="py-16 bg-[#2b1f38]">
  <div class="max-w-6xl mx-auto px-6">
    <h2 class="text-4xl font-bold text-center text-[#D4AF37] mb-12">Video Creation Tool</h2>

    <!-- Prompt Input + Templates -->
    <div class="mb-6">
      <label class="block text-lg font-semibold mb-2">Enter Your Prompt</label>
      <textarea id="prompt-input" class="w-full p-4 rounded-lg bg-[#3D2C41] text-white" rows="3" placeholder="Describe your scene..."></textarea>
      <div class="flex flex-wrap mt-2 gap-2">
        <button onclick="setPrompt('Funny')" class="btn">Funny</button>
        <button onclick="setPrompt('Cinematic')" class="btn">Cinematic</button>
        <button onclick="setPrompt('Fantasy')" class="btn">Fantasy</button>
        <button onclick="refinePrompt()" class="btn">Prompt Magic</button>
      </div>
      <!-- Ultra Cinematic Templates -->
      <div class="mt-3 flex flex-wrap gap-2">
        <button onclick="applyTemplate('Epic Battle')" class="btn bg-yellow-600">Epic Battle</button>
        <button onclick="applyTemplate('Royal Scene')" class="btn bg-yellow-600">Royal Scene</button>
        <button onclick="applyTemplate('Fantasy Land')" class="btn bg-yellow-600">Fantasy Land</button>
      </div>
    </div>

    <!-- Upload Photos + Batch -->
    <div class="mb-6">
      <label class="block text-lg font-semibold mb-2">Upload Photos (Photo-to-Video / Batch)</label>
      <input type="file" id="photo-upload" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white" multiple accept="image/png, image/jpeg">
      <p class="text-sm text-gray-300 mt-1">Pro/Diamond users can upload multiple prompts/photos for batch creation</p>
    </div>

    <!-- Video Options -->
    <div class="mb-6 grid md:grid-cols-3 gap-4">
      <div>
        <label class="block font-semibold mb-1">Model</label>
        <select id="model-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
          <option>Hyper-realistic</option>
          <option>Cinematic</option>
          <option>Fantasy</option>
        </select>
      </div>
      <div>
        <label class="block font-semibold mb-1">Resolution</label>
        <select id="resolution-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
          <option>720p</option>
          <option>1080p</option>
          <option>4K</option>
        </select>
      </div>
      <div>
        <label class="block font-semibold mb-1">Length</label>
        <select id="length-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
          <option>6 sec (Free)</option>
          <option>30 sec</option>
          <option>1 min</option>
        </select>
      </div>
    </div>

    <!-- Watermark / Branding (Paid Users) -->
    <div class="mb-6">
      <label class="block font-semibold mb-2">Upload Logo / Watermark (Paid)</label>
      <input type="file" id="watermark-upload" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white" accept="image/png">
    </div>

    <!-- Audio Overlay -->
    <div class="mb-6">
      <label class="block font-semibold mb-2">Optional Audio Track</label>
      <select id="audio-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
        <option>None</option>
        <option>Epic Music</option>
        <option>Cinematic Score</option>
        <option>Fantasy Tune</option>
      </select>
    </div>

    <!-- Generate / Clear Buttons -->
    <div class="flex flex-wrap gap-4 mb-6">
      <button onclick="generateVideo()" class="btn">Generate Video</button>
      <button onclick="clearVideo()" class="btn bg-red-600 hover:bg-red-700">Clear / Reset</button>
    </div>

    <!-- Loading & Video Preview -->
    <div id="video-preview" class="mt-6 text-center">
      <p id="loading-text" class="mb-2 hidden">Generating your video, please wait...</p>
      <div id="batch-progress" class="mb-2 hidden">Processing batch: <span id="current-batch">0</span>/<span id="total-batch">0</span></div>
      <video id="generated-video" class="mx-auto rounded-lg shadow-lg" controls style="max-width:100%; display:none;"></video>
      <div class="mt-2">
        <button id="regenerate-btn" class="btn mb-2 hidden" onclick="generateVideo()">Regenerate</button>
        <button id="download-btn" class="btn mb-2 hidden">Download</button>
      </div>
    </div>
  </div>
</section>

<script>
  // Prompt Functions
  function setPrompt(category){
    document.getElementById('prompt-input').value = category + ' prompt example...';
  }
  function refinePrompt(){
    const input = document.getElementById('prompt-input');
    input.value = "Refined: " + input.value;
  }
  function applyTemplate(template){
    document.getElementById('prompt-input').value = template + " cinematic template applied...";
  }

  // Clear Video
  function clearVideo(){
    document.getElementById('generated-video').style.display = "none";
    document.getElementById('regenerate-btn').classList.add('hidden');
    document.getElementById('download-btn').classList.add('hidden');
    document.getElementById('prompt-input').value = '';
    document.getElementById('photo-upload').value = '';
    document.getElementById('watermark-upload').value = '';
    document.getElementById('audio-select').value = 'None';
  }

  // Generate Video (Single / Batch)
  async function generateVideo(){
    const prompt = document.getElementById('prompt-input').value;
    const photos = document.getElementById('photo-upload').files;
    const model = document.getElementById('model-select').value;
    const resolution = document.getElementById('resolution-select').value;
    const length = document.getElementById('length-select').value;
    const watermark = document.getElementById('watermark-upload').files[0];
    const audio = document.getElementById('audio-select').value;

    if(!prompt && photos.length === 0){
      alert('Please enter a prompt or upload photos.');
      return;
    }

    document.getElementById('loading-text').classList.remove('hidden');
    document.getElementById('generated-video').style.display = 'none';
    document.getElementById('batch-progress').classList.add('hidden');

    try{
      // Handle batch videos (Pro/Diamond)
      const totalBatch = photos.length || 1;
      document.getElementById('total-batch').innerText = totalBatch;
      document.getElementById('batch-progress').classList.remove('hidden');

      for(let i=0; i<totalBatch; i++){
        document.getElementById('current-batch').innerText = i+1;

        const formData = new FormData();
        formData.append('prompt', prompt);
        formData.append('model', model);
        formData.append('resolution', resolution);
        formData.append('length', length);
        formData.append('audio', audio);
        if(watermark) formData.append('watermark', watermark);
        if(photos[i]) formData.append('photo', photos[i]);

        // Call backend AI endpoint
        const response = await fetch('https://your-backend-endpoint.com/generate', {
          method: 'POST',
          body: formData
        });

        const data = await response.json();
        if(data.videoUrl){
          const video = document.getElementById('generated-video');
          video.src = data.videoUrl;
          video.style.display = 'block';
          document.getElementById('regenerate-btn').classList.remove('hidden');
          document.getElementById('download-btn').classList.remove('hidden');
        } else {
          alert('Video generation failed for batch ' + (i+1));
        }
      }

    }catch(err){
      console.error(err);
      alert('Error generating video. Check console for details.');
    }finally{
      document.getElementById('loading-text').classList.add('hidden');
      document.getElementById('batch-progress').classList.add('hidden');
    }
  }
</script>
