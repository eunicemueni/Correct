<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
  body { font-family: 'Poppins', sans-serif; background-color: #1a1424; color: white; scroll-behavior: smooth; }
  .btn { background-color: #D4AF37; color: black; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; transition: all 0.2s; cursor: pointer; display: inline-block; text-align: center; }
  .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px #D4AF37; }
  .video-slide { max-width: 100%; border-radius: 0.5rem; box-shadow: 0 0 20px #000; }
  .discount-badge { background-color: #ff4d6d; color: white; padding: 0.2rem 0.5rem; font-size: 0.8rem; border-radius: 0.3rem; margin-left: 0.5rem; }
  .faq-question { font-weight: bold; margin-top: 1rem; }
  .footer-links a { color: #D4AF37; text-decoration: underline; }
</style>
</head>
<body>
<!-- Place this at the bottom, just before </body> -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kairah Studio Auth</title>
<script type="module" src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js"></script>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.3/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-[#2b1f38] flex items-center justify-center min-h-screen">

<div class="max-w-md w-full p-6 bg-[#3D2C41] rounded-2xl shadow-lg">
  <h2 class="text-3xl font-bold text-[#D4AF37] text-center mb-6">Kairah Studio</h2>

  <!-- Tabs -->
  <div class="flex justify-around mb-4">
    <button id="tab-signup" class="text-[#D4AF37] font-bold">Sign Up</button>
    <button id="tab-login" class="text-white">Login</button>
  </div>

  <!-- Signup Form -->
  <form id="signup-form" class="flex flex-col gap-4">
    <input type="text" id="signup-name" placeholder="Name" class="p-3 rounded-lg bg-[#2b1f38] text-white" required>
    <input type="email" id="signup-email" placeholder="Email" class="p-3 rounded-lg bg-[#2b1f38] text-white" required>
    <input type="password" id="signup-password" placeholder="Password" class="p-3 rounded-lg bg-[#2b1f38] text-white" required>
    <button type="submit" class="p-3 rounded-lg bg-[#D4AF37] text-black font-bold">Sign Up</button>
    <p id="signup-status" class="text-center mt-2"></p>
  </form>

  <!-- Login Form -->
  <form id="login-form" class="flex flex-col gap-4 hidden">
    <input type="email" id="login-email" placeholder="Email" class="p-3 rounded-lg bg-[#2b1f38] text-white" required>
    <input type="password" id="login-password" placeholder="Password" class="p-3 rounded-lg bg-[#2b1f38] text-white" required>
    <button type="submit" class="p-3 rounded-lg bg-[#D4AF37] text-black font-bold">Login</button>
    <p id="login-status" class="text-center mt-2"></p>
  </form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";

// üîë Replace this with your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAGlNOCAwsgeDnSJtBux2uIMuP0p_jBJns",
  authDomain: "kairah-studio.firebaseapp.com",
  projectId: "kairah-studio",
  storageBucket: "kairah-studio.appspot.com",
  messagingSenderId: "145122424961",
  appId: "1:145122424961:web:89c26c800c2d32c7503580",
  measurementId: "G-KBJT3RME4G"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// Tabs
const signupTab = document.getElementById("tab-signup");
const loginTab = document.getElementById("tab-login");
const signupForm = document.getElementById("signup-form");
const loginForm = document.getElementById("login-form");

signupTab.addEventListener("click", () => {
  signupForm.classList.remove("hidden");
  loginForm.classList.add("hidden");
  signupTab.classList.add("text-[#D4AF37]");
  loginTab.classList.remove("text-[#D4AF37]");
  loginTab.classList.add("text-white");
});
loginTab.addEventListener("click", () => {
  loginForm.classList.remove("hidden");
  signupForm.classList.add("hidden");
  loginTab.classList.add("text-[#D4AF37]");
  signupTab.classList.remove("text-[#D4AF37]");
  signupTab.classList.add("text-white");
});

// Signup
signupForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const name = document.getElementById("signup-name").value;
  const email = document.getElementById("signup-email").value;
  const password = document.getElementById("signup-password").value;
  const statusEl = document.getElementById("signup-status");
  statusEl.textContent = "Creating account...";

  try {
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    const user = userCredential.user;
    await sendEmailVerification(user);
    statusEl.textContent = "‚úÖ Account created! Check your email to verify.";
    signupForm.reset();
  } catch(err) {
    statusEl.textContent = `‚ùå ${err.message}`;
    console.error(err);
  }
});

// Login
loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("login-email").value;
  const password = document.getElementById("login-password").value;
  const statusEl = document.getElementById("login-status");
  statusEl.textContent = "Logging in...";

  try {
    const userCredential = await signInWithEmailAndPassword(auth, email, password);
    const user = userCredential.user;
    if(!user.emailVerified) {
      statusEl.textContent = "‚ùå Please verify your email before logging in.";
      return;
    }
    statusEl.textContent = "‚úÖ Login successful! Redirecting...";
    // Redirect to video tool
    setTimeout(() => { window.location.href = "/video-tool.html"; }, 1500);
  } catch(err) {
    statusEl.textContent = `‚ùå ${err.message}`;
    console.error(err);
  }
});
</script>

</body>
</html>
<section id="video-tool" class="py-16 bg-[#2b1f38]">
  <div class="max-w-6xl mx-auto px-6">
    <h2 class="text-4xl font-bold text-center text-[#D4AF37] mb-12">Video Creation Tool</h2>

    <!-- Prompt Input -->
    <div class="mb-6">
      <label class="block text-lg font-semibold mb-2">Enter Your Prompt</label>
      <textarea id="prompt-input" class="w-full p-4 rounded-lg bg-[#3D2C41] text-white" rows="3" placeholder="Describe your scene..."></textarea>
      <div class="flex flex-wrap mt-2 gap-2">
        <button onclick="setPrompt('Funny')" class="btn">Funny</button>
        <button onclick="setPrompt('Cinematic')" class="btn">Cinematic</button>
        <button onclick="setPrompt('Fantasy')" class="btn">Fantasy</button>
        <button onclick="applyTemplate('Ultra-Cinematic')" class="btn">Cinematic Template</button>
        <button onclick="refinePrompt()" class="btn">Prompt Magic</button>
      </div>
    </div>

    <!-- Upload Photos -->
    <div class="mb-6">
      <label class="block text-lg font-semibold mb-2">Upload Photos (Photo-to-Video)</label>
      <input type="file" id="photo-upload" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white" multiple accept="image/png, image/jpeg">
    </div>

    <!-- Watermark / Logo -->
    <div class="mb-6">
      <label class="block font-semibold mb-1">Watermark / Logo (Paid Users)</label>
      <input type="file" id="watermark-upload" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white" accept="image/png, image/jpeg">
    </div>

    <!-- Audio Overlay -->
    <div class="mb-6">
      <label class="block font-semibold mb-1">Audio Overlay (Optional)</label>
      <select id="audio-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
        <option value="None">None</option>
        <option value="Epic Music">Epic Music</option>
        <option value="Ambient">Ambient</option>
        <option value="Cinematic Voice">Cinematic Voice</option>
      </select>
    </div>

    <!-- Video Options -->
    <div class="mb-6 grid md:grid-cols-3 gap-4">
      <div>
        <label class="block font-semibold mb-1">Model</label>
        <select id="model-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
          <option>Hyper-realistic</option>
          <option>Cinematic</option>
          <option>Fantasy</option>
        </select>
      </div>
      <div>
        <label class="block font-semibold mb-1">Resolution</label>
        <select id="resolution-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
          <option>720p</option>
          <option>1080p</option>
          <option>4K</option>
        </select>
      </div>
      <div>
        <label class="block font-semibold mb-1">Length</label>
        <select id="length-select" class="w-full p-2 rounded-lg bg-[#3D2C41] text-white">
          <option>6 sec (Free)</option>
          <option>30 sec</option>
          <option>1 min</option>
        </select>
      </div>
    </div>

    <!-- Generate / Clear Buttons -->
    <div class="flex flex-wrap gap-4 mb-6">
      <button onclick="generateVideo(currentUser)" class="btn">Generate Video</button>
      <button onclick="clearVideo()" class="btn bg-red-600 hover:bg-red-700">Clear / Reset</button>
    </div>

    <!-- Loading, Batch & Video Preview -->
    <div id="video-preview" class="mt-6 text-center">
      <p id="loading-text" class="mb-2 hidden">Generating your video, please wait...</p>
      <p id="batch-progress" class="mb-2 hidden">Batch: <span id="current-batch">0</span> / <span id="total-batch">0</span></p>
      <video id="generated-video" class="mx-auto rounded-lg shadow-lg" controls style="max-width:100%; display:none;"></video>
      <div class="mt-2">
        <button id="regenerate-btn" class="btn mb-2 hidden" onclick="generateVideo(currentUser)">Regenerate</button>
        <button id="download-btn" class="btn mb-2 hidden">Download</button>
      </div>
      <div id="error-message" class="text-red-500 mt-2 font-semibold text-center"></div>
    </div>
  </div>
</section>

<script>
let currentUser = null; // Replace with your Firebase Auth user

function setPrompt(category) {
  document.getElementById('prompt-input').value = category + ' prompt example...';
}
function refinePrompt() {
  const input = document.getElementById('prompt-input');
  input.value = "Refined: " + input.value;
}
function applyTemplate(template) {
  document.getElementById('prompt-input').value = template + " cinematic template applied...";
}
function clearVideo() {
  document.getElementById('generated-video').style.display = "none";
  document.getElementById('regenerate-btn').classList.add('hidden');
  document.getElementById('download-btn').classList.add('hidden');
  document.getElementById('prompt-input').value = '';
  document.getElementById('photo-upload').value = '';
  document.getElementById('watermark-upload').value = '';
  document.getElementById('audio-select').value = 'None';
  document.getElementById('error-message').innerText = '';
}
function showError(message) {
  document.getElementById('error-message').innerText = message;
}
function clearError() {
  showError('');
}

async function generateVideo(user) {
  try {
    if(!user) {
      showError('‚ùå Please sign in first.');
      return;
    }

    const prompt = document.getElementById('prompt-input').value;
    const photos = document.getElementById('photo-upload').files;
    const model = document.getElementById('model-select').value;
    const resolution = document.getElementById('resolution-select').value;
    const length = document.getElementById('length-select').value;
    const watermark = document.getElementById('watermark-upload').files[0];
    const audio = document.getElementById('audio-select').value;

    if(!prompt && photos.length === 0) {
      showError('‚ùå Enter a prompt or upload at least one photo.');
      return;
    }

    clearError();
    document.getElementById('loading-text').classList.remove('hidden');
    document.getElementById('generated-video').style.display = 'none';
    document.getElementById('batch-progress').classList.remove('hidden');

    // Determine batch count
    const batchCount = (user.plan === 'pro' || user.plan === 'diamond') ? Math.max(photos.length,1) : 1;
    document.getElementById('total-batch').innerText = batchCount;

    for(let i=0; i<batchCount; i++){
      document.getElementById('current-batch').innerText = i+1;

      // ----- Replace with your AI backend call -----
      await new Promise(resolve => setTimeout(resolve, 1500)); // simulate generation delay
      const videoEl = document.getElementById('generated-video');
      videoEl.src = "https://streamable.com/e/6psp7n"; // example placeholder
      videoEl.style.display = 'block';
      document.getElementById('regenerate-btn').classList.remove('hidden');
      document.getElementById('download-btn').classList.remove('hidden');
    }

    document.getElementById('batch-progress').classList.add('hidden');

  } catch(err) {
    showError('‚ùå Video generation failed. Try again.');
  } finally {
    document.getElementById('loading-text').classList.add('hidden');
  }
}
</script>
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "firebase/auth";

const auth = getAuth();

// Example login function
async function login(email, password) {
  try {
    await signInWithEmailAndPassword(auth, email, password);
    // User is now signed in, redirect to video tool
    window.location.href = '/video-tool.html'; // Replace with your tool page path
  } catch (err) {
    console.error(err);
    alert('Login failed: ' + err.message);
  }
}

// Auto-redirect if already logged in
onAuthStateChanged(auth, (user) => {
  if (user) {
    // User is logged in
    window.location.href = '/video-tool.html'; // Only redirect if not already on video tool page
  }
});
